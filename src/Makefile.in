OCTFILES = avifile.oct aviread.oct aviinfo.oct addframe.oct
AVOBJS = AVHandler.o oct-avifile.o

MKOCTFILE ?= mkoctfile
MKOCTFLAGS ?= -Wall -v -Wno-deprecated-declarations

.PHONY: all clean realclean distclean

all: ${OCTFILES}

debug : MKOCTFLAGS += -ggdb -O0
debug : all

oct-avifile.o: AVHandler.o

${AVOBJS}: %.o: %.cc
	$(MKOCTFILE) $(MKOCTFLAGS) -c @DEFS@ $< -o $@ @CPPFLAGS@

${OCTFILES}: %.oct: %.cc AVHandler.o oct-avifile.o
	$(MKOCTFILE) $(MKOCTFLAGS) @DEFS@ $< $(filter %.o, $^) @LIBS@ @CPPFLAGS@

clean:
	rm -f *.o *.oct octave-workspace

distclean: clean
	rm -f Makefile

realclean: distclean
	rm -rf autom4te.cache
	rm -f config.status config.log config.h configure aclocal.m4
